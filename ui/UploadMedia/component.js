(()=>{var n=e=>{let s={},f=e.split(" ")[0];return new Proxy(function(){if(arguments.length>0){let c=[],r;for(r=0;r<arguments.length;r++)if(arguments[r]){if(typeof arguments[r]=="string"){c.push(arguments[r]);continue}c.push.apply(c,Array.isArray(arguments[r])?arguments[r]:Object.keys(arguments[r]).filter(l=>arguments[r][l]))}if(c.length>0)return(e+" "+c.join(" ")).replace(" --"," "+f+"--")}return e},{get:(c,r)=>(s[r]===void 0&&(s[r]=n(f+(r[0]==="_"?"_":"-")+r)),s[r])})};var C=e=>{let s=e.match(/(\d[\d,]*(?:\.\d+)?)([KMG])B/i);return parseInt(s?s[1]*{K:1024,M:1048576,G:1073741824}[s[2]]:e)},$=e=>{let s=0;for(;e>1e3;)e/=1024,s++;return Math.round(e*10)/10+["byte","KB","MB","GB","TB","PB"][s]};var t=window.React;var P=window.ReactDOM;var R=e=>{let{children:s,trace:f}=e,{render:c,useState:r,useMemo:l,useCallback:x,useEffect:h,useRef:b}=t,{createPortal:M}=P,a=b({contents:!1,setContents:()=>{}}),i=l(()=>{if(e.id){let m=document.getElementById(e.id);if(m)return m}let u=document.createElement("div");return e.id&&(u.id=e.id),e.className&&(u.className=e.className),document.body.appendChild(u),u},[]);return h(()=>{let{trace:u}=e;if(!u)return;i.style.position="absolute";let m=setInterval(()=>{if(u.getBoundingClientRect){let p=u.getBoundingClientRect();i.style.left=window.scrollX+p.left+"px",i.style.top=window.scrollY+p.top+"px",i.style.width=p.width+"px",i.style.height=p.height+"px"}},50);return()=>clearInterval(m)},[e.trace]),M(s,i)};var{useMemo:xr,useState:wr,useCallback:yr,useRef:br,useEffect:Mr,createContext:F,useContext:Er}=t,Cr=F();var I=(e,s)=>{let f=s.split(",").map(l=>l.trim()).filter(Boolean),c=e.type,r=e.name;return f.some(l=>{if(l.startsWith("."))return r.toLowerCase().endsWith(l.toLowerCase());if(l.endsWith("/*")){let x=l.slice(0,-1);return c.startsWith(x)}else return c===l})};Catpow.UI.UploadMedia=e=>{let{useState:s,useMemo:f,useCallback:c,useEffect:r}=window.React,{className:l="cmf-ui-uploadmedia",text:x="Select File",cmf:h,loaderDots:b=5}=e,{HiddenValues:M}=Catpow.Components,a=n(l),[i,u]=s(!1),[m,p]=s(!1),[E,w]=s(!1),[k,S]=s(!1),N=f(()=>e.filesize?C(e.filesize):!1,[e.filesize]),g=c(o=>{for(let d=0;d<o.length;d++){if(o[d].size>N){w("Too large File");return}if(!I(o[d],e.accept)){w("Invalid File type");return}}w(!1),p(!0);let v=new FormData;v.set(e.name,o[0]),h.send(v,function(d){if(p(!1),d.error){h.showError(d.error),h.focusAlert();return}d.files&&d.files[e.name]&&u(d.files[e.name])})},[w,u]),L=c(o=>{o.preventDefault(),o.dataTransfer.items?g([...o.dataTransfer.items].filter(v=>v.kind==="file").map(v=>v.getAsFile())):g(o.dataTransfer.files)},[g]),A=c(o=>{g(o.currentTarget.files)},[g]);return window.React.createElement("div",{className:a({"is-uploading":m}),onDrop:L,onDragOver:o=>o.preventDefault()},window.React.createElement("div",{className:a.button(),onClick:()=>k.click()},x,m&&window.React.createElement("div",{className:a.loader()},[...Array(b).keys()].map(o=>window.React.createElement("div",{className:a.loader._dot("is-dot-"+o),style:{"--dot-index":o},key:o})))),E&&window.React.createElement("div",{className:a.message()},E),i&&window.React.createElement("div",{className:a.preview(),key:i.name},window.React.createElement("div",{className:a.preview.images()},window.React.createElement("img",{className:a.preview.images.img(),src:h.getFileUrl(e.name)+"&fname="+i.file_name})),window.React.createElement("div",{className:a.preview.spec()},window.React.createElement("span",{className:a.preview.spec.name()},i.name),window.React.createElement("span",{className:a.preview.spec.size()},$(i.size)))),window.React.createElement(R,{className:a.portal()},window.React.createElement("form",{className:a.portal.form()},window.React.createElement("input",{className:a.portal.input(),type:"file",name:e.name,accept:e.accept,onChange:A,ref:S}))),i&&window.React.createElement(M,{name:e.name,value:i}))};})();
