(()=>{var n=e=>{let s={},p=e.split(" ")[0];return new Proxy(function(){if(arguments.length>0){let o=[],r;for(r=0;r<arguments.length;r++)if(arguments[r]){if(typeof arguments[r]=="string"){o.push(arguments[r]);continue}o.push.apply(o,Array.isArray(arguments[r])?arguments[r]:Object.keys(arguments[r]).filter(c=>arguments[r][c]))}if(o.length>0)return(e+" "+o.join(" ")).replace(" --"," "+p+"--")}return e},{get:(o,r)=>(s[r]===void 0&&(s[r]=n(p+(r[0]==="_"?"_":"-")+r)),s[r])})};var M=e=>{let s=e.match(/(\d[\d,]*(?:\.\d+)?)([KMG])B/i);return parseInt(s?s[1]*{K:1024,M:1048576,G:1073741824}[s[2]]:e)},E=e=>{let s=0;for(;e>1e3;)e/=1024,s++;return Math.round(e*10)/10+["byte","KB","MB","GB","TB","PB"][s]};var t=window.React;var C=window.ReactDOM;var $=e=>{let{children:s,trace:p}=e,{render:o,useState:r,useMemo:c,useCallback:w,useEffect:h,useRef:b}=t,{createPortal:a}=C,m=b({contents:!1,setContents:()=>{}}),d=c(()=>{if(e.id){let f=document.getElementById(e.id);if(f)return f}let l=document.createElement("div");return e.id&&(l.id=e.id),e.className&&(l.className=e.className),document.body.appendChild(l),l},[]);return h(()=>{let{trace:l}=e;if(!l)return;d.style.position="absolute";let f=setInterval(()=>{if(l.getBoundingClientRect){let v=l.getBoundingClientRect();d.style.left=window.scrollX+v.left+"px",d.style.top=window.scrollY+v.top+"px",d.style.width=v.width+"px",d.style.height=v.height+"px"}},50);return()=>clearInterval(f)},[e.trace]),a(s,d)};var{useMemo:hr,useState:vr,useCallback:gr,useRef:xr,useEffect:wr,createContext:L,useContext:yr}=t,br=L();var _=(e,s)=>{let p=s.split(",").map(c=>c.trim()).filter(Boolean),o=e.type,r=e.name;return p.some(c=>{if(c.startsWith("."))return r.toLowerCase().endsWith(c.toLowerCase());if(c.endsWith("/*")){let w=c.slice(0,-1);return o.startsWith(w)}else return o===c})};Catpow.UI.UploadMedia=e=>{let{useState:s,useMemo:p,useCallback:o,useEffect:r}=window.React,{className:c="cmf-ui-uploadmedia",text:w="Select File",cmf:h}=e,{HiddenValues:b}=Catpow.Components,a=n(c),[m,d]=s(!1),[l,f]=s(!1),[v,P]=s(!1),R=p(()=>e.filesize?M(e.filesize):!1,[e.filesize]),x=o(i=>{for(let u=0;u<i.length;u++){if(i[u].size>R){f("Too large File");return}if(!_(i[u],e.accept)){f("Invalid File type");return}}f(!1);let g=new FormData;g.set(e.name,i[0]),h.send(g,function(u){if(u.error){h.showError(u.error),h.focusAlert();return}u.files&&u.files[e.name]&&d(u.files[e.name])})},[f,d]),k=o(i=>{i.preventDefault(),i.dataTransfer.items?x([...i.dataTransfer.items].filter(g=>g.kind==="file").map(g=>g.getAsFile())):x(i.dataTransfer.files)},[x]),S=o(i=>{x(i.currentTarget.files)},[x]);return window.React.createElement("div",{className:a(),onDrop:k,onDragOver:i=>i.preventDefault()},window.React.createElement("div",{className:a.button(),onClick:()=>v.click()},w),l&&window.React.createElement("div",{className:a.message()},l),m&&window.React.createElement("div",{className:a.preview(),key:m.name},window.React.createElement("div",{className:a.preview.images()},window.React.createElement("img",{className:a.preview.images.img(),src:h.getFileUrl(e.name)+"&fname="+m.file_name})),window.React.createElement("div",{className:a.preview.spec()},window.React.createElement("span",{className:a.preview.spec.name()},m.name),window.React.createElement("span",{className:a.preview.spec.size()},E(m.size)))),window.React.createElement($,{className:a.portal()},window.React.createElement("form",{className:a.portal.form()},window.React.createElement("input",{className:a.portal.input(),type:"file",name:e.name,accept:e.accept,onChange:S,ref:P}))),m&&window.React.createElement(b,{name:e.name,value:m}))};})();
